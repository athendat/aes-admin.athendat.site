"use strict";(self.webpackChunkaes_admin=self.webpackChunkaes_admin||[]).push([[511],{7231:(Z,g,a)=>{a.d(g,{C:()=>v});var u=a(520),f=a(2340),n=a(5e3);const p=f.N.API_URL;let v=(()=>{class m{constructor(c){this._httpClient=c}uploadImage(c,l){const e=new FormData;return e.append("image",l,l.name),this._httpClient.post(`${p}/cloudinary/upload/${c}`,e)}removeImage(c){const l=(new u.LE).set("public_id",c);return this._httpClient.delete(`${p}/cloudinary/remove`,{params:l})}}return m.\u0275fac=function(c){return new(c||m)(n.LFG(u.eN))},m.\u0275prov=n.Yz7({token:m,factory:m.\u0275fac,providedIn:"root"}),m})()},7511:(Z,g,a)=>{a.r(g),a.d(g,{WizardModule:()=>X});var u=a(5357),f=a(8089),n=a(3075),p=a(9646),v=a(7579),m=a(2722),C=a(4787),c=a(8288),l=a(9784),e=a(5e3),x=a(413),z=a(1683),b=a(7231),I=a(1158),T=a(7261),_=a(5094),F=a(9808),y=a(2494),A=a(508),M=a(7423),U=a(5245),h=a(7322),N=a(8833),J=a(773),Q=a(4107);const D=["wizardMerchantNgForm"],E=["logoFileInput"];function W(r,i){if(1&r&&(e.TgZ(0,"fuse-alert",24),e._uU(1),e.qZA()),2&r){const o=e.oxw();e.Q6J("type",o.alert.type)("showIcon",!1),e.xp6(1),e.hij(" ",o.alert.message," ")}}function w(r,i){1&r&&(e.TgZ(0,"mat-error"),e._uU(1," El nombre del negocio es obligatorio. "),e.qZA())}function k(r,i){1&r&&(e.TgZ(0,"mat-error"),e._uU(1," El nombre del negocio debe contener entre 3 y 40 caracteres. "),e.qZA())}function B(r,i){if(1&r&&(e.TgZ(0,"mat-option",25),e._uU(1),e.qZA()),2&r){const o=i.$implicit;e.Q6J("value",o.name),e.xp6(1),e.hij(" ",o.name," ")}}function R(r,i){1&r&&(e.TgZ(0,"mat-error"),e._uU(1," Debe escoger un sector. "),e.qZA())}function Y(r,i){1&r&&(e.TgZ(0,"mat-error"),e._uU(1," La direcci\xf3n es obligatoria. "),e.qZA())}function S(r,i){1&r&&(e.TgZ(0,"mat-error"),e._uU(1," La direcci\xf3n debe contener entre 3 y 100 caracteres. "),e.qZA())}function L(r,i){if(1&r&&(e.TgZ(0,"mat-option",25),e._uU(1),e.qZA()),2&r){const o=i.$implicit;e.Q6J("value",o),e.xp6(1),e.hij(" ",o," ")}}function q(r,i){1&r&&(e.TgZ(0,"mat-error"),e._uU(1," Debe seleccionar una provincia. "),e.qZA())}function O(r,i){if(1&r&&(e.TgZ(0,"mat-option",25),e._uU(1),e.qZA()),2&r){const o=i.$implicit;e.Q6J("value",o.city),e.xp6(1),e.hij(" ",o.city," ")}}function P(r,i){1&r&&(e.TgZ(0,"mat-error"),e._uU(1," Debe seleccionar un municipio. "),e.qZA())}function $(r,i){1&r&&(e.TgZ(0,"span"),e._uU(1," Crear negocio "),e.qZA())}function j(r,i){1&r&&e._UZ(0,"mat-progress-spinner",26),2&r&&e.Q6J("diameter",24)("mode","indeterminate")}let G=(()=>{class r{constructor(o,t,s,d,ee,te,re,oe,ae){this._merchantService=o,this._changeDetectorRef=t,this._formBuilder=s,this._fuseConfirmationService=d,this._imagesService=ee,this._locationService=te,this._snackBar=re,this._router=oe,this.store=ae,this.merchant=null,this.cities=[],this.domainCode="",this.domains=[],this.isLoading=!1,this.stateCode="",this.states=[],this.statesCodes=[],this.stateSelected="",this.user=null,this.user$=(0,p.of)(null),this._unsubscribeAll=new v.x}ngOnInit(){var o;this.user$=this.store.select(C.rk),this.user$.subscribe(t=>this.user=t),this._merchantService.domains$.pipe((0,m.R)(this._unsubscribeAll)).subscribe(t=>{this.domains=t,this._changeDetectorRef.markForCheck()}),this._locationService.states$.pipe((0,m.R)(this._unsubscribeAll)).subscribe(t=>{this.states=t,this._changeDetectorRef.markForCheck()}),this._locationService.statesCodes$.pipe((0,m.R)(this._unsubscribeAll)).subscribe(t=>{this.statesCodes=t,this._changeDetectorRef.markForCheck()}),this.wizardMerchantForm=this._formBuilder.group({name:["",[n.kI.required,n.kI.minLength(3),n.kI.maxLength(255)]],domain:["",[n.kI.required]],description:["",[n.kI.maxLength(1e3)]],address:["",[n.kI.required,n.kI.minLength(3),n.kI.maxLength(255)]],state:["",[n.kI.required]],city:["",[n.kI.required]],country:[{value:"Cuba",disabled:!0},[n.kI.required]]}),null===(o=this.wizardMerchantForm.get("state"))||void 0===o||o.valueChanges.pipe((0,m.R)(this._unsubscribeAll)).subscribe(t=>{this._getCitiesByState(t),this._changeDetectorRef.markForCheck()})}ngOnDestroy(){this._unsubscribeAll.next(null),this._unsubscribeAll.complete()}uploadLogo(o){if(this.wizardMerchantForm.disable(),!o.length)return;const s=o[0];!["image/jpeg","image/jpg","image/webp","image/png"].includes(s.type)||this._imagesService.uploadImage("merchant",s).subscribe(d=>{this.wizardMerchantForm.enable(),this._snackBar.openFromComponent(l.h,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:5e3,data:{message:d.message,title:"Confirmaci\xf3n",type:"success",svgIcon:"mat_solid:done"}}),this.wizardMerchantForm.get("step3.logoUrl").setValue(d.data.secure_url),this._changeDetectorRef.markForCheck()})}removeLogo(){this.wizardMerchantForm.disable();const o=this.wizardMerchantForm.get("step3.logoUrl");o.value&&this._imagesService.removeImage(this.wizardMerchantForm.get("step3.logoUrl").value).subscribe(t=>{o.setValue(null),this.wizardMerchantForm.enable(),this._snackBar.openFromComponent(l.h,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:5e3,data:{message:t.message,title:"Confirmaci\xf3n",type:"success",svgIcon:"mat_solid:done"}}),this._changeDetectorRef.markForCheck()})}createMerchant(){this.isLoading=!0;const o=this.wizardMerchantForm.getRawValue();this._fuseConfirmationService.open({title:"Crear negocio",message:"\xbfEsta seguro que todos los datos son correctos?",icon:{show:!0,name:"mat_solid:help",color:"info"},actions:{confirm:{label:"Aceptar",color:"primary"}}}).afterClosed().subscribe(s=>{"confirmed"===s&&this._merchantService.createMerchant(o).subscribe(({data:d})=>{this.isLoading=!1,this._snackBar.openFromComponent(l.h,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:5e3,data:{message:d.createMerchant.message,title:"Confirmaci\xf3n",type:"success",svgIcon:"mat_solid:done"}}),this._router.navigateByUrl("/desktop"),this._changeDetectorRef.markForCheck()}),this._changeDetectorRef.markForCheck()})}clearForm(){this.wizardMerchantNgForm.resetForm()}trackByFn(o,t){return t.id||o}_getCitiesByState(o){o!==this.stateSelected&&this._locationService.getCitiesByState(o).subscribe(t=>{this.cities=t,this._changeDetectorRef.markForCheck()})}}return r.\u0275fac=function(o){return new(o||r)(e.Y36(x.c),e.Y36(e.sBO),e.Y36(n.qu),e.Y36(z.R),e.Y36(b.C),e.Y36(I.a),e.Y36(T.ux),e.Y36(u.F0),e.Y36(_.yh))},r.\u0275cmp=e.Xpm({type:r,selectors:[["ath-wizard"]],viewQuery:function(o,t){if(1&o&&(e.Gf(D,5),e.Gf(E,5)),2&o){let s;e.iGM(s=e.CRH())&&(t.wizardMerchantNgForm=s.first),e.iGM(s=e.CRH())&&(t._logoFileInput=s.first)}},decls:61,vars:41,consts:[[1,"flex","flex-col","flex-auto","min-w-0"],[1,"flex","flex-col","flex-auto","items-center","py-5","sm:p-10"],[1,"flex","flex-col","w-full","max-w-4xl"],[1,"mt-2","px-3","text-4xl","text-center","sm:text-5xl","text-primary","font-extrabold","tracking-tight","leading-tight"],[1,"mt-8","sm:mt-12","p-2","sm:p-10","sm:pb-7","shadow","rounded-2xl","bg-card"],["class","mb-8",3,"type","showIcon",4,"ngIf"],["wizardBusinessNgForm","ngForm",1,"p-4","flex","flex-col","gap-3",3,"formGroup"],["wizardBusinessNgForm",""],[1,"font-semibold","text-lg","text-center","w-full"],[1,"w-full","fuse-mat-dense"],["matInput","","required","",3,"type","formControlName","minlength","maxlength","placeholder"],[4,"ngIf"],[3,"formControlName"],[3,"value",4,"ngFor","ngForOf","ngForTrackBy"],[1,"w-full","fuse-mat-no-subscript"],["matPrefix","",1,"hidden","sm:flex","icon-size-5",3,"svgIcon"],["matInput","","matTextareaAutosize","",3,"formControlName","rows","maxlength","spellcheck"],["matInput","","required","",3,"type","formControlName","minlength","maxlength"],["matPrefix","",1,"icon-size-5",3,"svgIcon"],["required","",3,"formControlName"],[1,"w-full","fuse-mat-dense","fuse-mat-no-subscript"],["value","Cuba"],["mat-flat-button","",1,"w-full","mt-6","fuse-mat-button-large",3,"color","disabled","click"],[3,"diameter","mode",4,"ngIf"],[1,"mb-8",3,"type","showIcon"],[3,"value"],[3,"diameter","mode"]],template:function(o,t){1&o&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3),e._uU(4," Est\xe1 solo a un paso de empezar a utilizar nuestra plataforma, registre su negocio. "),e.qZA(),e.TgZ(5,"div",4),e.YNc(6,W,2,3,"fuse-alert",5),e.TgZ(7,"form",6,7)(9,"span",8),e._uU(10," Ingrese la informaci\xf3n m\xednima necesaria para que sus clientes conozcan el negocio. "),e.qZA(),e.TgZ(11,"mat-form-field",9)(12,"mat-label"),e._uU(13,"Nombre"),e.qZA(),e._UZ(14,"input",10),e.YNc(15,w,2,0,"mat-error",11),e.YNc(16,k,2,0,"mat-error",11),e.qZA(),e.TgZ(17,"mat-form-field",9)(18,"mat-label"),e._uU(19,"Sector"),e.qZA(),e.TgZ(20,"mat-select",12),e.YNc(21,B,2,2,"mat-option",13),e.qZA(),e.TgZ(22,"mat-hint"),e._uU(23,"Nomenclador de la Organizaci\xf3n Internacional del Trabajo OIT"),e.qZA(),e.YNc(24,R,2,0,"mat-error",11),e.qZA(),e.TgZ(25,"mat-form-field",14)(26,"mat-label"),e._uU(27,"Descripci\xf3n del Negocio"),e.qZA(),e._UZ(28,"mat-icon",15)(29,"textarea",16),e.qZA(),e.TgZ(30,"mat-form-field",9)(31,"mat-label"),e._uU(32,"Direcci\xf3n"),e.qZA(),e._UZ(33,"mat-icon",15)(34,"input",17),e.YNc(35,Y,2,0,"mat-error",11),e.YNc(36,S,2,0,"mat-error",11),e.qZA(),e.TgZ(37,"mat-form-field",9)(38,"mat-label"),e._uU(39,"Provincia"),e.qZA(),e._UZ(40,"mat-icon",18),e.TgZ(41,"mat-select",19),e.YNc(42,L,2,2,"mat-option",13),e.qZA(),e.YNc(43,q,2,0,"mat-error",11),e.qZA(),e.TgZ(44,"mat-form-field",9)(45,"mat-label"),e._uU(46,"Municipio"),e.qZA(),e._UZ(47,"mat-icon",18),e.TgZ(48,"mat-select",19),e.YNc(49,O,2,2,"mat-option",13),e.qZA(),e.YNc(50,P,2,0,"mat-error",11),e.qZA(),e.TgZ(51,"mat-form-field",20)(52,"mat-label"),e._uU(53,"Pa\xeds"),e.qZA(),e.TgZ(54,"mat-select",19)(55,"mat-option",21),e._uU(56,"Cuba"),e.qZA()(),e._UZ(57,"mat-icon",18),e.qZA(),e.TgZ(58,"button",22),e.NdJ("click",function(){return t.createMerchant()}),e.YNc(59,$,2,0,"span",11),e.YNc(60,j,1,2,"mat-progress-spinner",23),e.qZA()()()()()()),2&o&&(e.xp6(6),e.Q6J("ngIf",t.alert),e.xp6(1),e.Q6J("formGroup",t.wizardMerchantForm),e.xp6(7),e.Q6J("type","text")("formControlName","name")("minlength",3)("maxlength",255)("placeholder","Nombre del negocio"),e.xp6(1),e.Q6J("ngIf",t.wizardMerchantForm.get("name").hasError("required")),e.xp6(1),e.Q6J("ngIf",t.wizardMerchantForm.get("name").hasError("maxlength")||t.wizardMerchantForm.get("name").hasError("minlength")),e.xp6(4),e.Q6J("formControlName","domain"),e.xp6(1),e.Q6J("ngForOf",t.domains)("ngForTrackBy",t.trackByFn),e.xp6(3),e.Q6J("ngIf",t.wizardMerchantForm.get("domain").hasError("required")),e.xp6(4),e.Q6J("svgIcon","mat_solid:menu"),e.xp6(1),e.Q6J("formControlName","description")("rows",2)("maxlength",1e3)("spellcheck",!1),e.xp6(4),e.Q6J("svgIcon","mat_solid:home"),e.xp6(1),e.Q6J("type","text")("formControlName","address")("minlength",3)("maxlength",255),e.xp6(1),e.Q6J("ngIf",t.wizardMerchantForm.get("address").hasError("required")),e.xp6(1),e.Q6J("ngIf",t.wizardMerchantForm.get("address").hasError("maxlength")||t.wizardMerchantForm.get("address").hasError("minlength")),e.xp6(4),e.Q6J("svgIcon","mat_solid:map"),e.xp6(1),e.Q6J("formControlName","state"),e.xp6(1),e.Q6J("ngForOf",t.states)("ngForTrackBy",t.trackByFn),e.xp6(1),e.Q6J("ngIf",t.wizardMerchantForm.get("state").hasError("required")),e.xp6(4),e.Q6J("svgIcon","mat_solid:place"),e.xp6(1),e.Q6J("formControlName","city"),e.xp6(1),e.Q6J("ngForOf",t.cities)("ngForTrackBy",t.trackByFn),e.xp6(1),e.Q6J("ngIf",t.wizardMerchantForm.get("city").hasError("required")),e.xp6(4),e.Q6J("formControlName","country"),e.xp6(3),e.Q6J("svgIcon","mat_solid:public"),e.xp6(1),e.Q6J("color","primary")("disabled",t.wizardMerchantForm.pristine||t.wizardMerchantForm.invalid),e.xp6(1),e.Q6J("ngIf",!t.isLoading),e.xp6(1),e.Q6J("ngIf",t.isLoading))},dependencies:[F.sg,F.O5,n._Y,n.Fj,n.JJ,n.JL,n.Q7,n.wO,n.nD,n.sg,n.u,y.W,A.ey,M.lW,U.Hw,h.TO,h.KE,h.bx,h.hX,h.qo,N.Nt,J.Ou,Q.gD],encapsulation:2,data:{animation:c.L}}),r})();var K=a(1227),H=a(8058);const V=[{path:"",component:G,resolve:{location:K.N,domains:H.E}}];let X=(()=>{class r{}return r.\u0275fac=function(o){return new(o||r)},r.\u0275mod=e.oAB({type:r}),r.\u0275inj=e.cJS({imports:[u.Bz.forChild(V),f.m]}),r})()}}]);