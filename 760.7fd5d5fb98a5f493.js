"use strict";(self.webpackChunkaes_admin=self.webpackChunkaes_admin||[]).push([[760],{1760:(At,R,s)=>{s.r(R),s.d(R,{MarketingModule:()=>It});var u=s(5357),ee=s(4576),e=s(5e3);let te=(()=>{class n{constructor(){}ngOnInit(){}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-marketing"]],decls:1,vars:0,template:function(t,i){1&t&&e._UZ(0,"router-outlet")},dependencies:[u.lC],encapsulation:2}),n})();var F=s(9071),C=s(5245),ne=s(5899),E=s(2638);const ie=["*"];let ae=(()=>{class n{constructor(){}ngOnInit(){}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=e.Xpm({type:n,selectors:[["marketing-banners"]],ngContentSelectors:ie,decls:53,vars:16,consts:[["cdkScrollable","",1,"absolute","inset-0","min-w-0","overflow-y-auto"],[1,"flex","flex-col","p-6","sm:flex-row","flex-0","sm:items-center","sm:justify-between","pb-22","sm:pt-12","sm:pb-28","sm:px-10","bg-default","dark:bg-transparent"],[1,"flex-1","min-w-0"],[1,"flex-wrap","items-center","hidden","font-medium","sm:flex"],[1,"whitespace-nowrap","text-primary-500"],[1,"flex","items-center","ml-1","whitespace-nowrap"],[1,"icon-size-5","text-secondary",3,"svgIcon"],[1,"ml-1","text-primary-500"],[1,"ml-1","text-secondary"],[1,"flex","sm:hidden"],[1,"inline-flex","items-center","-ml-1.5","text-secondary","font-medium",3,"routerLink"],[1,"ml-1"],[1,"mt-2"],[1,"text-3xl","font-extrabold","leading-7","tracking-tight","truncate","md:text-4xl","sm:leading-10"],[1,"-mt-16","overflow-hidden","shadow","rounded-t-2xl","bg-card"],[1,"w-100","dark:bg-gray-900",3,"autoFocus","mode","opened","position"],["matDrawer",""],[1,"py-10"],[1,"extra-content"],[1,"mx-6","text-3xl","font-bold","tracking-tighter"],[1,"mx-6","mt-2"],[1,"flex","items-center"],[1,"mr-2","icon-size-5",3,"svgIcon"],[1,"text-lg","font-semibold"],[1,"flex","flex-col","flex-auto","mt-4"],[1,"mb-3","text-sm","leading-none"],[3,"mode","color","value"],[1,"mx-6","mt-10"],[1,"flex","flex-col"],[1,"flex-auto","p-6","sm:p-10"],[1,"border-2","border-gray-300","border-dashed","h-160","min-h-160","max-h-160","rounded-2xl"]],template:function(t,i){1&t&&(e.F$t(),e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div")(4,"div",3)(5,"div")(6,"a",4),e._uU(7,"Projects"),e.qZA()(),e.TgZ(8,"div",5),e._UZ(9,"mat-icon",6),e.TgZ(10,"a",7),e._uU(11,"Weekend Project"),e.qZA()(),e.TgZ(12,"div",5),e._UZ(13,"mat-icon",6),e.TgZ(14,"span",8),e._uU(15,"Overview"),e.qZA()()(),e.TgZ(16,"div",9)(17,"a",10),e._UZ(18,"mat-icon",6),e.TgZ(19,"span",11),e._uU(20,"Back"),e.qZA()()()(),e.TgZ(21,"div",12)(22,"h2",13),e._uU(23," Page heading "),e.qZA()()()(),e.TgZ(24,"mat-drawer-container",14)(25,"mat-drawer",15,16)(27,"div",17)(28,"div",18),e.Hsn(29),e.qZA(),e.TgZ(30,"div",19),e._uU(31,"Configurar mi ..."),e.qZA(),e.TgZ(32,"div",20)(33,"div",21),e._UZ(34,"mat-icon",22),e.TgZ(35,"div",23),e._uU(36,"Storage"),e.qZA()(),e.TgZ(37,"div",24)(38,"span",25),e._uU(39,"19.9 GB of 100 GB used"),e.qZA(),e._UZ(40,"mat-progress-bar",26),e.qZA()(),e.TgZ(41,"div",27)(42,"div",21),e._UZ(43,"mat-icon",22),e.TgZ(44,"div",23),e._uU(45,"Users"),e.qZA()(),e.TgZ(46,"div",24)(47,"span",25),e._uU(48,"8 of 20 users used"),e.qZA(),e._UZ(49,"mat-progress-bar",26),e.qZA()()()(),e.TgZ(50,"mat-drawer-content",28)(51,"div",29),e._UZ(52,"div",30),e.qZA()()()()),2&t&&(e.xp6(9),e.Q6J("svgIcon","mat_solid:chevron_right"),e.xp6(4),e.Q6J("svgIcon","mat_solid:chevron_right"),e.xp6(4),e.Q6J("routerLink","./.."),e.xp6(1),e.Q6J("svgIcon","mat_solid:chevron_left"),e.xp6(7),e.Q6J("autoFocus",!1)("mode","side")("opened",!0)("position","end"),e.xp6(9),e.Q6J("svgIcon","mat_solid:storage"),e.xp6(6),e.Q6J("mode","determinate")("color","primary")("value",19.9),e.xp6(3),e.Q6J("svgIcon","mat_solid:people"),e.xp6(6),e.Q6J("mode","determinate")("color","accent")("value",40))},dependencies:[u.yS,F.PQ,C.Hw,ne.pW,E.jA,E.kh,E.LW],encapsulation:2}),n})();var D=s(9646),B=s(7579),f=s(2722),S=s(4787),Z=s(5094);const L=n=>n.medias,oe=(0,Z.P1)(L,n=>n.media),M=(0,Z.P1)(L,n=>n.medias);var d=s(3075),I=s(8966),g=s(9784),P=s(7625),Y=s(2075),N=s(1683),G=s(7231),A=s(5698),w=s(3900),y=s(8505),q=s(7489),h=s(9387),$=s(5714),v=(s(2340),s(3921));const se=v.Ps`
    mutation CreateMedia($createMediaInput: CreateMediaInput!) {
        createMedia(createMediaInput: $createMediaInput) {

            ok
            message

            media {
                id
                active
                userId
                merchantId
                productId

                title
                subtitle
                externalLink
                reference
                time
                mediaType
                image
                imageId

            }
        }
    }
`,le=v.Ps`
    mutation UpdateMedia($updateMediaInput: UpdateMediaInput!) {
        updateMedia(updateMediaInput: $updateMediaInput) {

            ok
            message

            media {
                id
                active

                userId
                user

                merchantId
                merchant

                productId
                product

                title
                subtitle
                externalLink
                reference
                time
                mediaType
                image
                imageId

            }
        }
    }
`,ce=v.Ps`
    mutation Mutation($updateEntityStatusInput: UpdateEntityStatusInput!) {
        updateMediaStatus(updateEntityStatusInput: $updateEntityStatusInput){
            ok
            message
        }
    }
`,de=v.Ps`
    mutation RemoveMedia($removeMediaId: String!) {
        removeMedia(id: $removeMediaId) {
            ok
            message
        }
    }
`,me=v.Ps`
    query FindAllMedias($offset: Int, $limit: Int, $sort: String, $order: Order, $search: String) {
        findAllMedias(offset: $offset, limit: $limit, sort: $sort, order: $order, search: $search) {
            ok
            message

            pagination {
                length
                size
                page
            }

            medias {
                id
                active

                userId
                user

                merchantId
                merchant

                productId
                product

                title
                subtitle
                externalLink
                reference
                time
                mediaType
                image
                imageId

            }
        }
    }
`,pe=v.Ps`
    query FindAllMediasByMerchant($offset: Int, $limit: Int, $sort: String, $order: Order, $search: String) {
        findAllMediasByMerchant(offset: $offset, limit: $limit, sort: $sort, order: $order, search: $search) {
            ok
            message

            pagination {
                length
                size
                page
            }

            medias {
                id
                active
                userId
                productId

                title
                subtitle
                externalLink
                reference
                time
                mediaType
                image
                imageId

            }
        }
    }
`,ge=v.Ps`
    query FindMediaById($findMediaByIdId: String!) {
        findMediaById(id: $findMediaByIdId) {
            ok
            message

            media {
                id
                active

                userId
                user

                merchantId
                merchant

                productId
                product

                title
                subtitle
                externalLink
                reference
                time
                mediaType
                image
                imageId

            }
        }
    }
`;var ue=s(520),Q=s(7261);let k=(()=>{class n{constructor(t,i,a,r){this.apolloProvider=t,this._httpClient=i,this._snackBar=a,this.store=r,this._apollo=this.apolloProvider.use("AES")}createMedia(t){return this.store.select(M).pipe((0,A.q)(1),(0,w.w)(i=>this._apollo.mutate({mutation:se,variables:{createMediaInput:t},errorPolicy:"all"}).pipe((0,y.b)(({errors:a,data:r})=>{if(a){let l="";a.forEach(m=>{m.extensions.originalError.message.forEach(x=>l+=`\n ${x.message}.`)}),this._snackBar.openFromComponent(g.h,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:1e4,data:{message:l,title:"Error",type:"error",svgIcon:"mat_solid:error"}})}const c=(0,q.cloneDeep)(i);c.push(r.createMedia.media),this.store.dispatch((0,h.L5)({medias:c}))}))))}getMedias(t=1,i=10,a="name",r="asc",c=""){return this._apollo.query({query:me,errorPolicy:"all",variables:{offset:i*(t-1),limit:i,sort:a,order:r,search:c}}).pipe((0,y.b)(({errors:l,data:m})=>{if(l){let p="";l.forEach(x=>p+=`\n ${x.message}.`),this._snackBar.openFromComponent(g.h,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:1e4,data:{message:p,title:"Error",type:"error",svgIcon:"mat_solid:error"}})}this.store.dispatch((0,h.L5)({medias:m.findAllMedias.medias})),this.store.dispatch((0,$.Jr)({pagination:m.findAllMedias.pagination}))}))}getMediasByMerchant(t=1,i=10,a="name",r="asc",c=""){return this._apollo.query({query:pe,errorPolicy:"all",variables:{offset:i*(t-1),limit:i,sort:a,order:r,search:c}}).pipe((0,y.b)(({errors:l,data:m})=>{if(l){let p="";l.forEach(x=>p+=`\n ${x.message}.`),this._snackBar.openFromComponent(g.h,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:1e4,data:{message:p,title:"Error",type:"error",svgIcon:"mat_solid:error"}})}this.store.dispatch((0,h.L5)({medias:m.findAllMediasByMerchant.medias})),this.store.dispatch((0,$.Jr)({pagination:m.findAllMediasByMerchant.pagination}))}))}getMediaById(t){return this._apollo.query({query:ge,variables:{findMediaByIdId:t},errorPolicy:"all"}).pipe((0,y.b)(({errors:i,data:a})=>{if(i){let r="";i.forEach(c=>r+=`\n ${c.message}.`),this._snackBar.openFromComponent(g.h,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:1e4,data:{message:r,title:"Error",type:"error",svgIcon:"mat_solid:error"}})}this.store.dispatch((0,h.bC)({media:a.findMediaById.media}))}))}updateMedia(t){return this.store.select(M).pipe((0,A.q)(1),(0,w.w)(i=>this._apollo.mutate({mutation:le,variables:{updateMediaInput:t},errorPolicy:"all"}).pipe((0,y.b)(({errors:a,data:r})=>{if(a){let m="";a.forEach(p=>m+=`\n ${p.message}.`),this._snackBar.openFromComponent(g.h,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:1e4,data:{message:m,title:"Error",type:"error",svgIcon:"mat_solid:error"}})}const c=(0,q.cloneDeep)(i);c[i.findIndex(m=>m.id===t.id)]=r.updateMedia.media,this.store.dispatch((0,h.L5)({medias:c})),this.store.dispatch((0,h.bC)({media:r.updateMedia.media}))}))))}updateMediaStatus(t){return this.store.select(M).pipe((0,A.q)(1),(0,w.w)(i=>this._apollo.mutate({mutation:ce,variables:{updateEntityStatusInput:t},errorPolicy:"all"}).pipe((0,y.b)(({errors:a})=>{if(a){let l="";a.forEach(m=>l+=`\n ${m.message}.`),this._snackBar.openFromComponent(g.h,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:1e4,data:{message:l,title:"Error",type:"error",svgIcon:"mat_solid:error"}})}const r=(0,q.cloneDeep)(i);r[i.findIndex(l=>l.id===t.id)].active=t.active,this.store.dispatch((0,h.L5)({medias:r}))}))))}removeMedia(t){return this.store.select(M).pipe((0,A.q)(1),(0,w.w)(i=>this._apollo.mutate({mutation:de,variables:{removeMediaId:t},errorPolicy:"all"}).pipe((0,y.b)(({errors:a})=>{if(a){let l="";a.forEach(m=>l+=`\n ${m.message}.`),this._snackBar.openFromComponent(g.h,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:1e4,data:{message:l,title:"Error",type:"error",svgIcon:"mat_solid:error"}})}const r=(0,q.cloneDeep)(i),c=i.findIndex(l=>l.id===t);r.splice(c,1),this.store.dispatch((0,h.L5)({medias:r}))}))))}}return n.\u0275fac=function(t){return new(t||n)(e.LFG(v._M),e.LFG(ue.eN),e.LFG(Q.ux),e.LFG(Z.yh))},n.\u0275prov=e.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();var _=s(9808),z=s(508),U=s(7423),J=s(7322),O=s(8833),j=s(4107),fe=s(2368),H=s(3877);function _e(n,o){if(1&n&&(e.TgZ(0,"h2",7),e._uU(1),e.qZA()),2&n){const t=e.oxw();e.xp6(1),e.hij(" Agregar ",t.mediaType," ")}}function xe(n,o){if(1&n&&(e.TgZ(0,"h2",7),e._uU(1),e.qZA()),2&n){const t=e.oxw();e.xp6(1),e.hij(" Editar ",t.mediaType," ")}}function he(n,o){if(1&n&&(e.TgZ(0,"div",8)(1,"div",9)(2,"div",10)(3,"div",11)(4,"div",12)(5,"h6",13),e._uU(6,"Nombre"),e.qZA(),e.TgZ(7,"span",14),e._uU(8),e.qZA()()()()()()),2&n){const t=e.oxw();e.xp6(8),e.hij(" ",t.data.uom.name||"Sin nombre"," ")}}function ve(n,o){1&n&&(e.ynx(0),e.TgZ(1,"mat-form-field",19)(2,"mat-label"),e._uU(3,"Tipo de Banner"),e.qZA(),e.TgZ(4,"mat-select",29)(5,"mat-option",23),e._uU(6,"Peque\xf1o"),e.qZA(),e.TgZ(7,"mat-option",23),e._uU(8,"Grande"),e.qZA()()(),e.BQk()),2&n&&(e.xp6(4),e.Q6J("formControlName","bannerType"),e.xp6(1),e.Q6J("value","small"),e.xp6(2),e.Q6J("value","big"))}function ye(n,o){1&n&&(e.ynx(0),e.TgZ(1,"mat-form-field",19)(2,"mat-label"),e._uU(3,"Url"),e.qZA(),e._UZ(4,"input",30),e.qZA(),e.BQk()),2&n&&(e.xp6(4),e.Q6J("formControlName","externalLink")("placeholder","Https://..."))}function Ze(n,o){if(1&n&&(e.ynx(0),e.TgZ(1,"mat-option",23),e._uU(2),e.qZA(),e.BQk()),2&n){const t=o.$implicit;e.xp6(1),e.Q6J("value",t._id),e.xp6(1),e.Oqu(t.name)}}function Te(n,o){if(1&n&&(e.ynx(0),e.TgZ(1,"div",21)(2,"mat-form-field",31)(3,"mat-label",32),e._uU(4,"Producto"),e.qZA(),e.TgZ(5,"mat-select",29)(6,"mat-option",23),e._uU(7,"Seleccionar producto"),e.qZA(),e.YNc(8,Ze,3,2,"ng-container",33),e.ALo(9,"async"),e.qZA()()(),e.BQk()),2&n){const t=e.oxw(2);e.xp6(5),e.Q6J("formControlName","productId"),e.xp6(1),e.Q6J("value",""),e.xp6(2),e.Q6J("ngForOf",e.lcZ(9,3,t.products$))}}function Me(n,o){if(1&n){const t=e.EpF();e.ynx(0),e.TgZ(1,"div",34)(2,"image-cropper",35),e.NdJ("imageCropped",function(a){e.CHM(t);const r=e.oxw(2);return e.KtG(r.imageCropped(a))})("imageLoaded",function(){e.CHM(t);const a=e.oxw(2);return e.KtG(a.imageLoaded())})("cropperReady",function(){e.CHM(t);const a=e.oxw(2);return e.KtG(a.cropperReady())})("loadImageFailed",function(){e.CHM(t);const a=e.oxw(2);return e.KtG(a.loadImageFailed())}),e.qZA()(),e.BQk()}if(2&n){const t=e.oxw(2);e.xp6(2),e.Q6J("imageChangedEvent",t.imageChangedEvent)("maintainAspectRatio",!0)("aspectRatio",t.aspectRatio[t.data.mediaType])}}function ke(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"div",15)(1,"div",16)(2,"form",17)(3,"div",18)(4,"mat-form-field",19)(5,"mat-label"),e._uU(6,"T\xedtulo"),e.qZA(),e._UZ(7,"input",20),e.qZA()(),e.TgZ(8,"div",18)(9,"mat-form-field",19)(10,"mat-label"),e._uU(11,"Subt\xedtulo"),e.qZA(),e._UZ(12,"input",20),e.qZA()(),e.TgZ(13,"div",21)(14,"mat-form-field",19)(15,"mat-label"),e._uU(16,"Tipo de contenido"),e.qZA(),e.TgZ(17,"mat-select",22)(18,"mat-option",23),e._uU(19,"Carrusel"),e.qZA(),e.TgZ(20,"mat-option",23),e._uU(21,"Banner est\xe1tico"),e.qZA(),e.TgZ(22,"mat-option",23),e._uU(23,"Banner cuadrado"),e.qZA(),e.TgZ(24,"mat-option",23),e._uU(25,"Banner informativo"),e.qZA()()(),e.YNc(26,ve,9,3,"ng-container",6),e.TgZ(27,"mat-form-field",19)(28,"mat-label"),e._uU(29,"Referencia"),e.qZA(),e.TgZ(30,"mat-select",22)(31,"mat-option",23),e._uU(32,"Interno"),e.qZA(),e.TgZ(33,"mat-option",23),e._uU(34,"Externo"),e.qZA()()()(),e.YNc(35,ye,5,2,"ng-container",6),e.YNc(36,Te,10,5,"ng-container",6),e.TgZ(37,"div",24)(38,"span",25),e._uU(39,"Estado"),e.qZA(),e.TgZ(40,"mat-slide-toggle",26),e._uU(41),e.qZA()(),e.TgZ(42,"div",27)(43,"input",28),e.NdJ("change",function(a){e.CHM(t);const r=e.oxw();return e.KtG(r.fileChangeEvent(a))}),e.qZA(),e.YNc(44,Me,3,3,"ng-container",6),e.qZA()()()()}if(2&n){const t=e.oxw();e.xp6(2),e.Q6J("formGroup",t.mediaForm)("autocomplete","off"),e.xp6(5),e.Q6J("formControlName","title")("placeholder","T\xedtulo"),e.xp6(5),e.Q6J("formControlName","subtitle")("placeholder","Subt\xedtulo"),e.xp6(5),e.Q6J("formControlName","mediaType"),e.xp6(1),e.Q6J("value","carousel"),e.xp6(2),e.Q6J("value","wide-banner"),e.xp6(2),e.Q6J("value","square-banner"),e.xp6(2),e.Q6J("value","info-banner"),e.xp6(2),e.Q6J("ngIf","square-banner"===t.mediaForm.get("mediaType").value),e.xp6(4),e.Q6J("formControlName","reference"),e.xp6(1),e.Q6J("value","internal"),e.xp6(2),e.Q6J("value","external"),e.xp6(2),e.Q6J("ngIf","external"===t.mediaForm.get("reference").value),e.xp6(1),e.Q6J("ngIf","internal"===t.mediaForm.get("reference").value),e.xp6(4),e.Q6J("formControlName","active")("color","primary"),e.xp6(1),e.hij(" ",!0===t.mediaForm.get("active").value?"Activo":"Inactivo"," "),e.xp6(3),e.Q6J("ngIf",t.showCropper)}}function be(n,o){if(1&n){const t=e.EpF();e.ynx(0),e.TgZ(1,"button",38),e.NdJ("click",function(){e.CHM(t);const a=e.oxw(2);return e.KtG(a.updateMedia())}),e._uU(2," Actualizar "),e.qZA(),e.BQk()}if(2&n){const t=e.oxw(2);e.xp6(1),e.Q6J("color","primary")("disabled",t.mediaForm.invalid)("matDialogClose","confirmed")}}function Ce(n,o){if(1&n){const t=e.EpF();e.ynx(0),e.TgZ(1,"button",38),e.NdJ("click",function(){e.CHM(t);const a=e.oxw(2);return e.KtG(a.createMedia())}),e._uU(2," Agregar "),e.qZA(),e.BQk()}if(2&n){const t=e.oxw(2);e.xp6(1),e.Q6J("color","primary")("disabled",t.mediaForm.invalid)("matDialogClose","confirmed")}}function Ie(n,o){if(1&n&&(e.ynx(0),e.TgZ(1,"div",36),e.ynx(2),e.TgZ(3,"button",37),e._uU(4," Cancelar "),e.qZA(),e.BQk(),e.YNc(5,be,3,3,"ng-container",6),e.YNc(6,Ce,3,3,"ng-container",6),e.qZA(),e.BQk()),2&n){const t=e.oxw();e.xp6(3),e.Q6J("matDialogClose","cancelled"),e.xp6(2),e.Q6J("ngIf","edit"===t.data.dialogMode),e.xp6(1),e.Q6J("ngIf","add"===t.data.dialogMode)}}let Ae=(()=>{class n{constructor(t,i,a,r,c,l,m,p,x){this.data=t,this._changeDetectorRef=i,this._dialogRef=a,this._formBuilder=r,this._fuseConfirmationService=c,this._imagesService=l,this._marketingService=m,this._snackBar=p,this.store=x,this.dialogMode="view",this.user=null,this.products$=(0,D.of)([]),this.showCropper=!1,this.merchantId="",this.aspectRatio={carousel:1920/805,static:768/151,square:1},this.imageChangedEvent="",this.croppedImage="",this._unsubscribeAll=new B.x}ngOnInit(){this.products$=this.store.select(Y.nR),this.store.select(P.Q).pipe((0,f.R)(this._unsubscribeAll)).subscribe(t=>this.merchantId=t.id),this.mediaForm=this._formBuilder.group({id:[null],title:["Gran Descuento",[d.kI.required,d.kI.minLength(3),d.kI.maxLength(255)]],subtitle:["Audio profesional en todos los momentos de vida",[d.kI.required,d.kI.minLength(3),d.kI.maxLength(255)]],reference:["internal",[d.kI.required]],externalLink:[""],productId:[""],time:[null],mediaType:["",[d.kI.required]],image:[""],imageId:[""]}),this.mediaForm.get("reference").valueChanges.pipe((0,f.R)(this._unsubscribeAll)).subscribe(t=>{"internal"===t&&this.mediaForm.get("externalLink").reset(),"external"===t&&this.mediaForm.get("productId").reset(),this._changeDetectorRef.markForCheck()})}ngOnDestroy(){this._unsubscribeAll.next(null),this._unsubscribeAll.complete()}closeDialog(){this._dialogRef.close()}fileChangeEvent(t){this.imageChangedEvent=t,this.showCropper=!0}imageCropped(t){this.croppedImage=t.base64}imageLoaded(t){}cropperReady(){}loadImageFailed(){}createMedia(){console.log("File:",this.imageChangedEvent.target.files[0]);const t=this.mediaForm.getRawValue();this._fuseConfirmationService.open({title:"Crear contenido",message:"\xbfEsta seguro que toda la informaci\xf3n es correcta?",icon:{show:!0,name:"mat_solid:help",color:"info"},actions:{confirm:{label:"Aceptar",color:"primary"}}}).afterClosed().subscribe(a=>{"confirmed"===a&&this._imagesService.uploadImage("Media",this.imageChangedEvent.target.files[0]).pipe((0,f.R)(this._unsubscribeAll)).subscribe(({imageUrl:r})=>{t.image=r,this._marketingService.createMedia(t).subscribe(({data:c})=>{this._snackBar.openFromComponent(g.h,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:5e3,data:{message:c.createMedia.message,title:"Confirmaci\xf3n",type:"success",svgIcon:"mat_solid:done"}}),this.closeDialog()}),this._changeDetectorRef.markForCheck()})})}_base64ToFile(t,i){console.log("data:",t);const a=t.split(","),r=a[0].match(/:(.*?);/)[1],c=atob(a[1]);let l=c.length;const m=new Uint8Array(l);for(;l--;)m[l]=c.charCodeAt(l);return new File([m],i,{type:r})}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(I.WI),e.Y36(e.sBO),e.Y36(I.so),e.Y36(d.qu),e.Y36(N.R),e.Y36(G.C),e.Y36(k),e.Y36(Q.ux),e.Y36(Z.yh))},n.\u0275cmp=e.Xpm({type:n,selectors:[["media-dialog"]],decls:11,vars:5,consts:[[1,"relative","flex","flex-col","w-full","max-h-screen"],[1,"flex","flex-col","items-center","px-8","pt-4","space-y-1","text-center","sm:items-start","sm:mt-0","sm:pr-8","sm:text-left"],["class","text-2xl text-gray-400",4,"ngIf"],["cdkScrollable","","fuseScrollbar","",1,"flex","flex-col","items-center","flex-auto","w-full","px-8","pb-6","sm:flex-row","sm:items-start","sm:pb-8"],["class","flex-auto",4,"ngIf"],["class","w-full overflow-hidden",4,"ngIf"],[4,"ngIf"],[1,"text-2xl","text-gray-400"],[1,"flex-auto"],[1,"flex"],[1,"flex","flex-col","w-full","mt-5"],[1,"flex","flex-col","p-8","pb-0","sm:flex-row"],[1,"w-full","py-10","my-10"],[1,"mb-2","font-medium"],[1,"border-sm"],[1,"w-full","overflow-hidden"],[1,"flex","flex-col"],[1,"flex","flex-col","w-full","mt-1",3,"formGroup","autocomplete"],[1,"py-5"],[1,"w-full","fuse-mat-no-subscript"],["matInput","","type","text","required","","maxlength","250",3,"formControlName","placeholder"],[1,"flex","flex-col","w-full","gap-5","py-5","md:flex-row"],["required","",3,"formControlName"],[3,"value"],[1,"flex","flex-col","mt-4"],[1,"mb-4","font-medium"],[3,"formControlName","color"],[1,"flex","flex-col","w-full","gap-5","pt-5","md:flex-row"],["type","file",3,"change"],[3,"formControlName"],["matInput","","type","text","maxlength","250",3,"formControlName","placeholder"],[1,"w-full","mt-2","fuse-mat-no-subscript"],[1,"mb-4"],[4,"ngFor","ngForOf"],[1,"max-w-60"],["format","webp",3,"imageChangedEvent","maintainAspectRatio","aspectRatio","imageCropped","imageLoaded","cropperReady","loadImageFailed"],[1,"flex","items-center","justify-center","px-6","py-4","space-x-3","sm:justify-between","bg-gray-50","dark:bg-black","dark:bg-opacity-10"],["mat-stroked-button","",3,"matDialogClose"],["mat-flat-button","",3,"color","disabled","matDialogClose","click"]],template:function(t,i){1&t&&(e.TgZ(0,"div",0),e.ynx(1),e.TgZ(2,"div",1),e.YNc(3,_e,2,1,"h2",2),e.YNc(4,xe,2,1,"h2",2),e.qZA(),e.BQk(),e.TgZ(5,"div",3),e.ynx(6),e.YNc(7,he,9,1,"div",4),e.BQk(),e.ynx(8),e.YNc(9,ke,45,21,"div",5),e.BQk(),e.qZA(),e.YNc(10,Ie,7,3,"ng-container",6),e.qZA()),2&t&&(e.xp6(3),e.Q6J("ngIf","add"===i.data.dialogMode),e.xp6(1),e.Q6J("ngIf","edit"===i.data.dialogMode),e.xp6(3),e.Q6J("ngIf","view"===i.data.dialogMode),e.xp6(2),e.Q6J("ngIf","edit"===i.data.dialogMode||"add"),e.xp6(1),e.Q6J("ngIf","view"!==i.data.dialogMode))},dependencies:[_.sg,_.O5,d._Y,d.Fj,d.JJ,d.JL,d.Q7,d.nD,d.sg,d.u,F.PQ,z.ey,U.lW,I.ZT,J.KE,J.hX,O.Nt,j.gD,fe.Rr,H.ap,_.Ov],encapsulation:2}),n})();var K=s(9602);function we(n,o){1&n&&(e.ynx(0),e.TgZ(1,"h2",18),e._uU(2," Carrusel "),e.qZA(),e.BQk())}function qe(n,o){1&n&&(e.ynx(0),e.TgZ(1,"h2",18),e._uU(2," Descuento "),e.qZA(),e.BQk())}function Qe(n,o){1&n&&(e.ynx(0),e.TgZ(1,"h2",18),e._uU(2," Banner p\xe1gina de inicio "),e.qZA(),e.BQk())}function Ue(n,o){1&n&&(e.ynx(0),e.TgZ(1,"h2",18),e._uU(2," Banner p\xe1gina de productos "),e.qZA(),e.BQk())}function Je(n,o){1&n&&(e.ynx(0),e.TgZ(1,"h2",18),e._uU(2," Secci\xf3n Ofertas "),e.qZA(),e.BQk())}function Fe(n,o){1&n&&(e.ynx(0),e.TgZ(1,"h2",18),e._uU(2," Secci\xf3n informativa "),e.qZA(),e.BQk())}const V=function(){return["/modules/marketing/panels/media"]},Ee=function(n,o){return{mediaType:n,mode:"edit",mediaId:o}};function De(n,o){if(1&n){const t=e.EpF();e.ynx(0),e.TgZ(1,"fuse-card",23)(2,"div",24)(3,"div",25),e._uU(4),e.qZA(),e.TgZ(5,"div",26),e._uU(6),e.qZA(),e.TgZ(7,"a",27),e._uU(8," VER DETALLES "),e.qZA()()(),e.TgZ(9,"div",28)(10,"button",29),e._UZ(11,"mat-icon",30),e.qZA(),e.TgZ(12,"button",31),e.NdJ("click",function(){e.CHM(t);const a=e.oxw(2).$implicit,r=e.oxw(2);return e.KtG(r.deleteMedia(a._id))}),e._UZ(13,"mat-icon",30),e.qZA()(),e.BQk()}if(2&n){const t=e.oxw(2).$implicit,i=e.oxw(2);e.xp6(1),e.Jzz("background-image: url(",t.image,");"),e.xp6(3),e.Oqu(t.title),e.xp6(2),e.hij("",t.subtitle," "),e.xp6(4),e.Q6J("routerLink",e.DdM(9,V))("queryParams",e.WLB(10,Ee,i.mediaType,t._id)),e.xp6(1),e.Q6J("svgIcon","mat_solid:edit"),e.xp6(2),e.Q6J("svgIcon","mat_solid:delete")}}function Be(n,o){if(1&n&&(e.TgZ(0,"div"),e.YNc(1,De,14,13,"ng-container",10),e.qZA()),2&n){const t=e.oxw().$implicit,i=e.oxw(2);e.xp6(1),e.Q6J("ngIf",t.mediaType===i.mediaType)}}function Ne(n,o){if(1&n&&(e.ynx(0),e.TgZ(1,"div",32)(2,"div",33),e._UZ(3,"img",34),e.qZA(),e.TgZ(4,"div",35)(5,"div",36),e._uU(6),e.qZA(),e.TgZ(7,"div",37),e._uU(8),e.qZA()()(),e.BQk()),2&n){const t=e.oxw(2).$implicit;e.xp6(3),e.Q6J("src",""===t.image?t.productId.thumbnail:t.image,e.LSH),e.xp6(3),e.hij(" ",t.title," "),e.xp6(2),e.hij(" ",t.subtitle," ")}}function Re(n,o){if(1&n&&(e.TgZ(0,"div"),e.YNc(1,Ne,9,3,"ng-container",16),e.qZA()),2&n){const t=e.oxw().$implicit,i=e.oxw(2),a=e.MAs(34);e.xp6(1),e.Q6J("ngIf",t.mediaType===i.mediaType)("ngIfElse",a)}}function Se(n,o){1&n&&(e.ynx(0),e._uU(1," square "),e.BQk())}function Le(n,o){if(1&n&&(e.TgZ(0,"div"),e.YNc(1,Se,2,0,"ng-container",16),e.qZA()),2&n){const t=e.oxw().$implicit,i=e.oxw(2),a=e.MAs(34);e.xp6(1),e.Q6J("ngIf",t.mediaType===i.mediaType)("ngIfElse",a)}}function Pe(n,o){if(1&n&&(e.ynx(0),e._UZ(1,"div",38),e.BQk()),2&n){const t=e.oxw(2).$implicit;e.xp6(1),e.Jzz("background-image: url(",t.image,"); ")}}function Ye(n,o){if(1&n&&(e.TgZ(0,"div"),e.YNc(1,Pe,2,3,"ng-container",16),e.qZA()),2&n){const t=e.oxw().$implicit,i=e.oxw(2),a=e.MAs(34);e.xp6(1),e.Q6J("ngIf",t.mediaType===i.mediaType)("ngIfElse",a)}}function Ge(n,o){1&n&&(e.ynx(0),e._uU(1," Informativo "),e.BQk())}function $e(n,o){if(1&n&&(e.TgZ(0,"div"),e.YNc(1,Ge,2,0,"ng-container",16),e.qZA()),2&n){const t=e.oxw().$implicit,i=e.oxw(2),a=e.MAs(34);e.xp6(1),e.Q6J("ngIf",t.mediaType===i.mediaType)("ngIfElse",a)}}function ze(n,o){if(1&n&&(e.ynx(0),e.TgZ(1,"div",21),e.YNc(2,Be,2,1,"div",22),e.YNc(3,Re,2,2,"div",22),e.YNc(4,Le,2,2,"div",22),e.YNc(5,Ye,2,2,"div",22),e.YNc(6,$e,2,2,"div",22),e.qZA(),e.BQk()),2&n){const t=e.oxw(2);e.xp6(1),e.Q6J("ngSwitch",t.mediaType),e.xp6(1),e.Q6J("ngSwitchCase","carousel"),e.xp6(1),e.Q6J("ngSwitchCase","small-banner"),e.xp6(1),e.Q6J("ngSwitchCase","square-banner"),e.xp6(1),e.Q6J("ngSwitchCase","wide-banner"),e.xp6(1),e.Q6J("ngSwitchCase","info-banner")}}function Oe(n,o){if(1&n&&(e.ynx(0),e.TgZ(1,"div",19),e.YNc(2,ze,7,6,"ng-container",20),e.qZA(),e.BQk()),2&n){const t=e.oxw();e.xp6(2),e.Q6J("ngForOf",t.medias)}}function je(n,o){1&n&&(e.TgZ(0,"div",39),e._uU(1," \xa1No se ha creado este tipo contenido multimedia! "),e.qZA())}const He=function(){return["/desktop"]},Ke=function(){return["/modules/marketing"]},Ve=function(n){return{mediaType:n}};let We=(()=>{class n{constructor(t,i,a,r,c,l,m,p){this._activatedRoute=t,this._changeDetectorRef=i,this._dialog=a,this._fuseConfirmationService=r,this._marketingService=c,this._router=l,this._snackBar=m,this.store=p,this.medias$=(0,D.of)([]),this.medias=[],this.user=null,this._unsubscribeAll=new B.x}ngOnInit(){this._activatedRoute.queryParams.subscribe(({mediaType:t})=>this.mediaType=t),this.store.select(S.rk).pipe((0,f.R)(this._unsubscribeAll)).subscribe(t=>this.user=t),this.store.select(M).pipe((0,f.R)(this._unsubscribeAll)).subscribe(t=>{this.medias=t.filter(i=>i.mediaType===this.mediaType),this._changeDetectorRef.markForCheck()})}ngOnDestroy(){this._unsubscribeAll.next(null),this._unsubscribeAll.complete()}openDialog(t,i="add"){this._dialog.open(Ae,{data:{user:this.user,mediaType:this.mediaType,dialogMode:i},panelClass:"ath-dialog-panel"})}deleteMedia(t){this._fuseConfirmationService.open({title:"Eliminar contenido",message:"\xbfEsta seguro que eliminar este contenido?",icon:{show:!0,name:"mat_solid:help",color:"info"},actions:{confirm:{label:"Aceptar",color:"primary"}}}).afterClosed().subscribe(a=>{"confirmed"===a&&(this._marketingService.removeMedia(t).subscribe(({data:r})=>{this._snackBar.openFromComponent(g.h,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:5e3,data:{message:r.removeMedia.message,title:"Confirmaci\xf3n",type:"success",svgIcon:"mat_solid:done"}})}),this._changeDetectorRef.markForCheck())})}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(u.gz),e.Y36(e.sBO),e.Y36(I.uw),e.Y36(N.R),e.Y36(k),e.Y36(u.F0),e.Y36(Q.ux),e.Y36(Z.yh))},n.\u0275cmp=e.Xpm({type:n,selectors:[["marketing-gallery"]],decls:35,vars:21,consts:[[1,"flex","flex-col","flex-auto","min-w-0"],[1,"flex","flex-col","p-6","border-b","sm:flex-row","flex-0","sm:items-center","sm:justify-between","sm:py-8","sm:px-10","bg-card","dark:bg-transparent"],[1,"flex-1","min-w-0"],[1,"flex","flex-wrap","items-center","font-medium"],[1,"whitespace-nowrap","text-primary-500",3,"routerLink"],[1,"flex","items-center","ml-1","whitespace-nowrap"],[1,"icon-size-5","text-secondary",3,"svgIcon"],[1,"ml-1","text-primary-500",3,"routerLink"],[1,"ml-1","text-secondary"],[1,"mt-2"],[4,"ngIf"],[1,"flex","items-center","mt-6","shrink-0","sm:mt-0","sm:ml-4"],["mat-flat-button","",3,"color","routerLink","queryParams"],[1,"mr-2","icon-size-5",3,"svgIcon"],[1,"flex-auto","p-6","sm:p-10"],[1,"max-w-4xl","prose-sm","prose"],[4,"ngIf","ngIfElse"],["noMedia",""],[1,"text-3xl","font-extrabold","leading-7","tracking-tight","truncate","md:text-4xl","sm:leading-10"],[1,"flex","flex-wrap","gap-10","mt-8","w-full"],[4,"ngFor","ngForOf"],[3,"ngSwitch"],[4,"ngSwitchCase"],[1,"p-10","bg-cover","rounded-sm","w-160","h-60","filter-article"],[1,"flex","flex-col","justify-center"],[1,"text-4xl","font-bold","leading-tight"],[1,"my-2","text-2xl","font-medium","leading-tight"],["mat-flat-button","",1,"bg-blue-300","p-2.5","rounded-sm","max-w-30","mt-6"],[1,"flex","flex-row","w-full","p-2.5","bg-card","gap-2.5","justify-center"],["mat-stroked-button","",1,"px-2","leading-6","min-w-10","min-h-7","h-7",3,"routerLink","queryParams"],[1,"icon-size-5",3,"svgIcon"],["mat-stroked-button","",1,"px-2","leading-6","min-w-10","min-h-7","h-7",3,"click"],[1,"flex","flex-row","p-5","gap-5","bg-card","rounded-sm"],[1,"w-36","h-36"],["alt","Media image",3,"src"],[1,"flex","flex-col","gap-2","justify-center"],[1,"text-4xl","font-bold"],[1,"text-lg"],[1,"p-10","bg-cover","rounded-sm","w-full","filter-article","wide-banner"],[1,"p-8","text-4xl","font-semibold","tracking-tight","text-center","border-t","sm:p-16"]],template:function(t,i){if(1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div")(5,"a",4),e._uU(6,"Escritorio"),e.qZA()(),e.TgZ(7,"div",5),e._UZ(8,"mat-icon",6),e.TgZ(9,"a",7),e._uU(10,"Marketing"),e.qZA()(),e.TgZ(11,"div",5),e._UZ(12,"mat-icon",6),e.TgZ(13,"span",8),e._uU(14,"Galer\xeda"),e.qZA()()(),e.TgZ(15,"div",9),e.YNc(16,we,3,0,"ng-container",10),e.YNc(17,qe,3,0,"ng-container",10),e.YNc(18,Qe,3,0,"ng-container",10),e.YNc(19,Ue,3,0,"ng-container",10),e.YNc(20,Je,3,0,"ng-container",10),e.YNc(21,Fe,3,0,"ng-container",10),e.qZA()(),e.TgZ(22,"div",11)(23,"a",12),e._UZ(24,"mat-icon",13),e._uU(25," Nuevo "),e.qZA()()(),e.TgZ(26,"div",14)(27,"div",15)(28,"h2"),e._uU(29,"Listado de diapositivas creadas para el carrusel principal de la tienda."),e.qZA(),e.TgZ(30,"p"),e._uU(31," En este modulo podr\xe1 publicar contenido gr\xe1fico que haga menci\xf3n a su producto o negocio para que todos los clientes lo conozcan. "),e.qZA()(),e.YNc(32,Oe,3,1,"ng-container",16),e.YNc(33,je,2,0,"ng-template",null,17,e.W1O),e.qZA()()),2&t){const a=e.MAs(34);e.xp6(5),e.Q6J("routerLink",e.DdM(16,He)),e.xp6(3),e.Q6J("svgIcon","mat_solid:chevron_right"),e.xp6(1),e.Q6J("routerLink",e.DdM(17,Ke)),e.xp6(3),e.Q6J("svgIcon","mat_solid:chevron_right"),e.xp6(4),e.Q6J("ngIf","carousel"===i.mediaType),e.xp6(1),e.Q6J("ngIf","discount"===i.mediaType),e.xp6(1),e.Q6J("ngIf","banner_home"===i.mediaType),e.xp6(1),e.Q6J("ngIf","banner_product"===i.mediaType),e.xp6(1),e.Q6J("ngIf","offer"===i.mediaType),e.xp6(1),e.Q6J("ngIf","info"===i.mediaType),e.xp6(2),e.Q6J("color","primary")("routerLink",e.DdM(18,V))("queryParams",e.VKq(19,Ve,i.mediaType)),e.xp6(1),e.Q6J("svgIcon","mat_solid:add"),e.xp6(8),e.Q6J("ngIf",i.medias.length>0)("ngIfElse",a)}},dependencies:[u.rH,u.yS,_.sg,_.O5,_.RF,_.n9,K.y,U.lW,U.zs,C.Hw],encapsulation:2}),n})();const T=function(){return["gallery"]},Xe=function(){return{mediaType:"carousel"}},et=function(){return{mediaType:"discount"}},tt=function(){return{mediaType:"banner_home"}},nt=function(){return{mediaType:"banner_product"}},it=function(){return{mediaType:"offer"}},at=function(){return{mediaType:"info"}};let ot=(()=>{class n{constructor(){}ngOnInit(){}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=e.Xpm({type:n,selectors:[["marketing-panel"]],decls:69,vars:27,consts:[[1,"flex","flex-col","flex-auto","w-full"],[1,"flex","flex-wrap","w-full","max-w-screen-xl","p-6","mx-auto","md:p-8"],[1,"flex","items-center","justify-between","w-full"],[1,"text-3xl","font-semibold","leading-8","tracking-tight"],[1,"font-medium","tracking-tight","text-secondary"],[1,"grid","w-full","grid-cols-1","gap-8","mt-6","sm:grid-cols-2","lg:grid-cols-4","md:mt-8"],["routerLink","/modules/crm/panels/customers",1,"flex","flex-col","flex-auto","p-6","overflow-hidden","transition-shadow","duration-100","ease-linear","shadow","cursor-pointer","bg-card","rounded-2xl","hover:shadow-lg"],[1,"flex","items-start","justify-between"],[1,"text-lg","font-medium","leading-6","tracking-tight","truncate"],[1,"ml-2"],[1,"h-6","px-2","bg-yellow-100","rounded-lg","min-h-6"],[1,"font-mono","text-lg","font-medium","text-yellow-900"],[1,"flex","flex-col","flex-auto","p-6","overflow-hidden","transition-shadow","duration-100","ease-linear","shadow","cursor-pointer","bg-card","rounded-2xl","hover:shadow-lg"],[1,"w-full","mt-12"],[1,"text-2xl","font-semibold","leading-6","tracking-tight"],[1,"grid","w-full","grid-cols-1","gap-8","mt-6","sm:grid-cols-2","lg:grid-cols-3","md:mt-8"],[1,"flex","flex-col","flex-auto","p-6","overflow-hidden","shadow","bg-card","rounded-2xl"],[1,"flex","items-start","justify-start"],[1,"mr-3",3,"svgIcon"],[1,"flex","flex-col","mt-5"],[1,"flex","items-center","justify-start","p-1.5","cursor-pointer","rounded-lg","hover:bg-hover",3,"routerLink","queryParams"],[1,"flex","items-center","justify-center","w-6","h-6","mr-3","rounded-lg","bg-primary-100"],[1,"w-1","h-1","rounded-full","bg-primary-500"],[1,"text-lg","leading-6","tracking-tight"]],template:function(t,i){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div")(4,"div",3),e._uU(5,"Marketing"),e.qZA(),e.TgZ(6,"div",4),e._uU(7," Este m\xf3dulo est\xe1 dedicado a todos los componentes que le ayudaran a potenciar sus ventas en nuestra plataforma. "),e.qZA()()(),e.TgZ(8,"div",5)(9,"div",6)(10,"div",7)(11,"div",8),e._uU(12,"Clientes"),e.qZA(),e.TgZ(13,"div",9)(14,"div",10)(15,"span",11),e._uU(16),e.qZA()()()()(),e.TgZ(17,"div",6)(18,"div",7)(19,"div",8),e._uU(20,"Subscriptores"),e.qZA(),e.TgZ(21,"div",9)(22,"div",10)(23,"span",11),e._uU(24),e.qZA()()()()(),e.TgZ(25,"div",12)(26,"div",7)(27,"div",8),e._uU(28,"Estad\xedsticas"),e.qZA()()()(),e.TgZ(29,"div",13)(30,"div",14),e._uU(31,"Reportes y Listados"),e.qZA()(),e.TgZ(32,"div",15)(33,"div",16)(34,"div",17),e._UZ(35,"mat-icon",18),e.TgZ(36,"div",8),e._uU(37,"Multimedia"),e.qZA()(),e.TgZ(38,"div",19)(39,"div",20)(40,"div",21),e._UZ(41,"div",22),e.qZA(),e.TgZ(42,"div",23),e._uU(43,"Carrusel"),e.qZA()(),e.TgZ(44,"div",20)(45,"div",21),e._UZ(46,"div",22),e.qZA(),e.TgZ(47,"div",23),e._uU(48,"Descuentos"),e.qZA()(),e.TgZ(49,"div",20)(50,"div",21),e._UZ(51,"div",22),e.qZA(),e.TgZ(52,"div",23),e._uU(53,"Banners p\xe1gina de inicio"),e.qZA()(),e.TgZ(54,"div",20)(55,"div",21),e._UZ(56,"div",22),e.qZA(),e.TgZ(57,"div",23),e._uU(58,"Banners p\xe1gina de productos"),e.qZA()(),e.TgZ(59,"div",20)(60,"div",21),e._UZ(61,"div",22),e.qZA(),e.TgZ(62,"div",23),e._uU(63,"Ofertas"),e.qZA()(),e.TgZ(64,"div",20)(65,"div",21),e._UZ(66,"div",22),e.qZA(),e.TgZ(67,"div",23),e._uU(68,"Informaciones"),e.qZA()()()()()()()),2&t&&(e.xp6(16),e.Oqu(0),e.xp6(8),e.Oqu(0),e.xp6(11),e.Q6J("svgIcon","mat_solid:description"),e.xp6(4),e.Q6J("routerLink",e.DdM(15,T))("queryParams",e.DdM(16,Xe)),e.xp6(5),e.Q6J("routerLink",e.DdM(17,T))("queryParams",e.DdM(18,et)),e.xp6(5),e.Q6J("routerLink",e.DdM(19,T))("queryParams",e.DdM(20,tt)),e.xp6(5),e.Q6J("routerLink",e.DdM(21,T))("queryParams",e.DdM(22,nt)),e.xp6(5),e.Q6J("routerLink",e.DdM(23,T))("queryParams",e.DdM(24,it)),e.xp6(5),e.Q6J("routerLink",e.DdM(25,T))("queryParams",e.DdM(26,at)))},dependencies:[u.rH,C.Hw],encapsulation:2}),n})();var rt=s(1588),b=(()=>{return(n=b||(b={})).carousel="carousel",n.discount="discount",n.banner_home="banner_home",n.banner_product="banner_product",n.offer="offer",n.info="info",b;var n})();function st(n,o){1&n&&(e.ynx(0),e.TgZ(1,"h2",28),e._uU(2," Carrusel "),e.qZA(),e.BQk())}function lt(n,o){1&n&&(e.ynx(0),e.TgZ(1,"h2",28),e._uU(2," Descuento "),e.qZA(),e.BQk())}function ct(n,o){1&n&&(e.ynx(0),e.TgZ(1,"h2",28),e._uU(2," Banner p\xe1gina de inicio "),e.qZA(),e.BQk())}function dt(n,o){1&n&&(e.ynx(0),e.TgZ(1,"h2",28),e._uU(2," Banner p\xe1gina de productos "),e.qZA(),e.BQk())}function mt(n,o){1&n&&(e.ynx(0),e.TgZ(1,"h2",28),e._uU(2," Secci\xf3n Ofertas "),e.qZA(),e.BQk())}function pt(n,o){1&n&&(e.ynx(0),e.TgZ(1,"h2",28),e._uU(2," Secci\xf3n informativa "),e.qZA(),e.BQk())}function gt(n,o){if(1&n){const t=e.EpF();e.ynx(0),e.TgZ(1,"a",29),e.NdJ("click",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.createMedia())}),e._UZ(2,"mat-icon",30),e._uU(3," Guardar "),e.qZA(),e.BQk()}2&n&&(e.xp6(1),e.Q6J("color","primary"),e.xp6(1),e.Q6J("svgIcon","mat_solid:save"))}function ut(n,o){if(1&n){const t=e.EpF();e.ynx(0),e.TgZ(1,"a",29),e.NdJ("click",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.updateMedia())}),e._UZ(2,"mat-icon",30),e._uU(3," Actualizar "),e.qZA(),e.BQk()}2&n&&(e.xp6(1),e.Q6J("color","primary"),e.xp6(1),e.Q6J("svgIcon","mat_solid:cached"))}function ft(n,o){if(1&n){const t=e.EpF();e.ynx(0),e.TgZ(1,"mat-option",31),e.NdJ("click",function(){const r=e.CHM(t).$implicit,c=e.oxw();return e.KtG(c.selectAspectRatio(r.value))}),e._uU(2),e.qZA(),e.BQk()}if(2&n){const t=o.$implicit,i=e.oxw();e.xp6(1),e.Q6J("value",t.value),e.xp6(1),e.hij(" ",i.displayMediaTypeText(t.value)," ")}}function _t(n,o){1&n&&(e.ynx(0),e.TgZ(1,"mat-form-field",20)(2,"mat-label"),e._uU(3,"Url"),e.qZA(),e._UZ(4,"input",32),e.qZA(),e.BQk()),2&n&&(e.xp6(4),e.Q6J("formControlName","externalLink")("placeholder","https://..."))}function xt(n,o){if(1&n&&(e.ynx(0),e.TgZ(1,"mat-option",25),e._uU(2),e.qZA(),e.BQk()),2&n){const t=o.$implicit;e.xp6(1),e.Q6J("value",t.id),e.xp6(1),e.Oqu(t.name)}}function ht(n,o){if(1&n&&(e.ynx(0),e.TgZ(1,"div",22)(2,"mat-form-field",33)(3,"mat-label",34),e._uU(4,"Producto"),e.qZA(),e.TgZ(5,"mat-select",35)(6,"mat-option",25),e._uU(7,"Seleccionar producto"),e.qZA(),e.YNc(8,xt,3,2,"ng-container",24),e.ALo(9,"async"),e.qZA()()(),e.BQk()),2&n){const t=e.oxw();e.xp6(5),e.Q6J("formControlName","productId"),e.xp6(1),e.Q6J("value",""),e.xp6(2),e.Q6J("ngForOf",e.lcZ(9,3,t.products$))}}function vt(n,o){if(1&n){const t=e.EpF();e.ynx(0),e.TgZ(1,"div",36)(2,"image-cropper",37),e.NdJ("imageCropped",function(a){e.CHM(t);const r=e.oxw();return e.KtG(r.imageCropped(a))})("imageLoaded",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.imageLoaded())})("cropperReady",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.cropperReady())})("loadImageFailed",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.loadImageFailed())}),e.qZA()(),e.BQk()}if(2&n){const t=e.oxw();e.xp6(2),e.Q6J("imageChangedEvent",t.imageChangedEvent)("maintainAspectRatio",!0)("aspectRatio",t.aspectRatioSelected)}}function yt(n,o){if(1&n&&(e.TgZ(0,"div"),e._UZ(1,"img",38),e.qZA()),2&n){const t=e.oxw();e.xp6(1),e.Q6J("src",t.croppedImage,e.LSH)}}function Zt(n,o){if(1&n&&(e.ynx(0),e.TgZ(1,"div",39)(2,"fuse-card",40)(3,"div",41)(4,"div",42),e._uU(5),e.qZA(),e.TgZ(6,"div",43),e._uU(7),e.qZA(),e.TgZ(8,"a",44),e._uU(9," VER DETALLES "),e.qZA()()()(),e.BQk()),2&n){const t=e.oxw();e.xp6(2),e.Jzz("background-image: url(",""===t.croppedImage?t.mediaForm.get("image").value:t.croppedImage,");"),e.xp6(3),e.Oqu(t.mediaForm.get("title").value),e.xp6(2),e.hij("",t.mediaForm.get("subtitle").value," ")}}const Tt=function(){return["/desktop"]},Mt=function(){return["/modules/marketing"]};let kt=(()=>{class n{constructor(t,i,a,r,c,l,m,p,x){this._activatedRoute=t,this._changeDetectorRef=i,this._formBuilder=a,this._fuseConfirmationService=r,this._imagesService=c,this._marketingService=l,this._router=m,this._snackBar=p,this.store=x,this.aspectRatio={carousel:1920/805,discount:1,info:1,offer:1,banner_home:768/151,banner_product:768/151},this.aspectRatioSelected=1920/805,this.croppedImage="",this.imageChangedEvent="",this.mediaType=b.carousel,this.mediaTypes=b,this.merchantId="",this.media=null,this.mediaId="",this.mode="add",this.products$=(0,D.of)([]),this.showCropper=!1,this.user=null,this._unsubscribeAll=new B.x}ngOnInit(){this._activatedRoute.queryParams.subscribe(({mediaType:t,mode:i,mediaId:a})=>{this.mediaType=t,this.mediaId=a,this.mode=void 0!==i?i:"add"}),this.products$=this.store.select(Y.nR),this.store.select(S.rk).pipe((0,f.R)(this._unsubscribeAll)).subscribe(t=>this.user=t),this.store.select(P.Q).pipe((0,f.R)(this._unsubscribeAll)).subscribe(t=>this.merchantId=t.id),this.store.select(oe).pipe((0,f.R)(this._unsubscribeAll)).subscribe(t=>this.media=t),this.mediaForm=this._formBuilder.group({id:[null],title:[null,[d.kI.required,d.kI.minLength(3),d.kI.maxLength(255)]],subtitle:[null,[d.kI.required,d.kI.minLength(3),d.kI.maxLength(255)]],reference:["internal",[d.kI.required]],externalLink:[null],productId:[null],time:[null],mediaType:[this.mediaType,[d.kI.required]],image:[null],imageId:[null]}),this.mediaForm.get("reference").valueChanges.pipe((0,f.R)(this._unsubscribeAll)).subscribe(t=>{"internal"===t&&this.mediaForm.get("externalLink").reset(),"external"===t&&this.mediaForm.get("productId").reset(),this._changeDetectorRef.markForCheck()}),"edit"===this.mode&&(this.mediaForm.patchValue(this.media),this.mediaForm.get("productId").patchValue(this.media.productId))}ngOnDestroy(){this._unsubscribeAll.next(null),this._unsubscribeAll.complete()}backToGallery(){this._router.navigate(["/modules/marketing/panels/gallery"],{queryParams:{mediaType:this.mediaType}})}fileChangeEvent(t){this.imageChangedEvent=t,this.showCropper=!0}imageCropped(t){this.croppedImage=t.base64}imageLoaded(t){}cropperReady(){}loadImageFailed(){}createMedia(){const t=this.mediaForm.getRawValue();delete t.id,this._fuseConfirmationService.open({title:"Crear contenido",message:"\xbfEsta seguro que toda la informaci\xf3n es correcta?",icon:{show:!0,name:"mat_solid:help",color:"info"},actions:{confirm:{label:"Aceptar",color:"primary"}}}).afterClosed().subscribe(a=>{"confirmed"===a&&(""!==this.croppedImage?this._imagesService.uploadImage("media",this._croppedImageToFile(this.croppedImage,(0,rt.Z)())).pipe((0,f.R)(this._unsubscribeAll)).subscribe(r=>{console.log({response:r}),t.image=r.data.secure_url,t.imageId=r.data.public_id,this._marketingService.createMedia(t).subscribe(({data:c})=>{this._snackBar.openFromComponent(g.h,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:5e3,data:{message:c.createMedia.message,title:"Confirmaci\xf3n",type:"success",svgIcon:"mat_solid:done"}}),this._router.navigate(["/modules/marketing/panels/gallery"],{queryParams:{mediaType:this.mediaType}})}),this._changeDetectorRef.markForCheck()}):this._marketingService.createMedia(t).subscribe(({data:r})=>{this._snackBar.openFromComponent(g.h,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:5e3,data:{message:r.createMedia.message,title:"Confirmaci\xf3n",type:"success",svgIcon:"mat_solid:done"}}),this._router.navigate(["/modules/marketing/panels/gallery"],{queryParams:{mediaType:this.mediaType}})}))})}updateMedia(){const t=this.mediaForm.getRawValue();this._fuseConfirmationService.open({title:"Actualizar contenido",message:"\xbfEsta seguro que toda la informaci\xf3n es correcta?",icon:{show:!0,name:"mat_solid:help",color:"info"},actions:{confirm:{label:"Aceptar",color:"primary"}}}).afterClosed().subscribe(a=>{"confirmed"===a&&(""!==this.croppedImage?(console.log("Actualizando imagen"),this._imagesService.uploadImage("Media",this.imageChangedEvent.target.files[0]).pipe((0,f.R)(this._unsubscribeAll)).subscribe(({imageUrl:r})=>{t.image=r,this._marketingService.updateMedia(t).subscribe(({data:c})=>{this._snackBar.openFromComponent(g.h,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:5e3,data:{message:c.updateMedia.message,title:"Confirmaci\xf3n",type:"success",svgIcon:"mat_solid:done"}}),this._router.navigate(["/modules/marketing/panels/gallery"],{queryParams:{mediaType:this.mediaType}})}),this._changeDetectorRef.markForCheck()})):(console.log("Actualizando contenido manteniendo imagen"),this._marketingService.updateMedia(t).subscribe(({data:r})=>{this._snackBar.openFromComponent(g.h,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:5e3,data:{message:r.updateMedia.message,title:"Confirmaci\xf3n",type:"success",svgIcon:"mat_solid:done"}}),this._router.navigate(["/modules/marketing/panels/gallery"],{queryParams:{mediaType:this.mediaType}})})))})}selectAspectRatio(t){this.aspectRatioSelected=this.aspectRatio[t]}displayMediaTypeText(t){switch(t){case"carousel":default:return"Carrusel";case"discount":return"Descuento";case"banner_home":return"Banner p\xe1gina de inicio";case"banner_product":return"Banner p\xe1gina de productos";case"offer":return"Ofertas";case"info":return"Informaci\xf3n"}}_croppedImageToFile(t,i){const a=t.split(","),r=a[0].match(/:(.*?);/)[1],c=atob(a[1]);let l=c.length;const m=new Uint8Array(l);for(;l--;)m[l]=c.charCodeAt(l);return new File([m],i+"."+r.split("/")[1],{type:r})}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(u.gz),e.Y36(e.sBO),e.Y36(d.qu),e.Y36(N.R),e.Y36(G.C),e.Y36(k),e.Y36(u.F0),e.Y36(Q.ux),e.Y36(Z.yh))},n.\u0275cmp=e.Xpm({type:n,selectors:[["marketing-media"]],decls:68,vars:33,consts:[[1,"flex","flex-col","flex-auto","min-w-0"],[1,"flex","flex-col","p-6","border-b","sm:flex-row","flex-0","sm:items-center","sm:justify-between","sm:py-8","sm:px-10","bg-card","dark:bg-transparent"],[1,"flex-1","min-w-0"],[1,"flex","flex-wrap","items-center","font-medium"],[1,"whitespace-nowrap","text-primary-500",3,"routerLink"],[1,"flex","items-center","ml-1","whitespace-nowrap"],[1,"icon-size-5","text-secondary",3,"svgIcon"],[1,"ml-1","text-primary-500",3,"routerLink"],[1,"ml-1","text-primary-500","cursor-pointer",3,"click"],[1,"ml-1","text-secondary"],[1,"mt-2"],[4,"ngIf"],[1,"flex","items-center","mt-6","shrink-0","sm:mt-0","sm:ml-4"],[1,"flex-auto","p-6","sm:p-10"],[1,"relative","flex","flex-col","w-full"],["cdkScrollable","","fuseScrollbar","",1,"flex","flex-col","items-center","flex-auto","w-full","px-8","pb-6","sm:flex-row","sm:items-start","sm:pb-8"],[1,"w-full","overflow-hidden"],[1,"flex","flex-col"],[1,"flex","flex-col","w-full","mt-1",3,"formGroup","autocomplete"],[1,"py-5"],[1,"w-full","fuse-mat-no-subscript"],["matInput","","type","text","required","","maxlength","250",3,"formControlName","placeholder"],[1,"flex","flex-col","w-full","gap-5","py-5","md:flex-row"],["required","",3,"formControlName"],[4,"ngFor","ngForOf"],[3,"value"],[1,"flex","flex-col","w-full","gap-5","pt-5","md:flex-row"],["type","file",3,"change"],[1,"text-3xl","font-extrabold","leading-7","tracking-tight","truncate","md:text-4xl","sm:leading-10"],["mat-flat-button","",3,"color","click"],[1,"mr-2","icon-size-5",3,"svgIcon"],[3,"value","click"],["matInput","","type","text","maxlength","250",3,"formControlName","placeholder"],[1,"w-full","mt-2","fuse-mat-no-subscript"],[1,"mb-4"],[3,"formControlName"],[1,"max-w-60"],["format","webp",3,"imageChangedEvent","maintainAspectRatio","aspectRatio","imageCropped","imageLoaded","cropperReady","loadImageFailed"],[3,"src"],[1,"flex","flex-col","mt-4"],[1,"p-10","bg-cover","rounded-sm","w-160","h-60","filter-article"],[1,"flex","flex-col","justify-center"],[1,"text-4xl","font-bold","leading-tight"],[1,"my-2","text-2xl","font-medium","leading-tight"],["mat-flat-button","",1,"bg-blue-300","p-2.5","rounded-sm","max-w-30","mt-6"]],template:function(t,i){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div")(5,"a",4),e._uU(6,"Escritorio"),e.qZA()(),e.TgZ(7,"div",5),e._UZ(8,"mat-icon",6),e.TgZ(9,"a",7),e._uU(10,"Marketing"),e.qZA()(),e.TgZ(11,"div",5),e._UZ(12,"mat-icon",6),e.TgZ(13,"a",8),e.NdJ("click",function(){return i.backToGallery()}),e._uU(14,"Galer\xeda"),e.qZA()(),e.TgZ(15,"div",5),e._UZ(16,"mat-icon",6),e.TgZ(17,"span",9),e._uU(18,"Media"),e.qZA()()(),e.TgZ(19,"div",10),e.YNc(20,st,3,0,"ng-container",11),e.YNc(21,lt,3,0,"ng-container",11),e.YNc(22,ct,3,0,"ng-container",11),e.YNc(23,dt,3,0,"ng-container",11),e.YNc(24,mt,3,0,"ng-container",11),e.YNc(25,pt,3,0,"ng-container",11),e.qZA()(),e.TgZ(26,"div",12),e.YNc(27,gt,4,2,"ng-container",11),e.YNc(28,ut,4,2,"ng-container",11),e.qZA()(),e.TgZ(29,"div",13)(30,"div",14)(31,"div",15),e.ynx(32),e.TgZ(33,"div",16)(34,"div",17)(35,"form",18)(36,"div",19)(37,"mat-form-field",20)(38,"mat-label"),e._uU(39,"T\xedtulo"),e.qZA(),e._UZ(40,"input",21),e.qZA()(),e.TgZ(41,"div",19)(42,"mat-form-field",20)(43,"mat-label"),e._uU(44,"Subt\xedtulo"),e.qZA(),e._UZ(45,"input",21),e.qZA()(),e.TgZ(46,"div",22)(47,"mat-form-field",20)(48,"mat-label"),e._uU(49,"Tipo de contenido"),e.qZA(),e.TgZ(50,"mat-select",23),e.YNc(51,ft,3,2,"ng-container",24),e.ALo(52,"keyvalue"),e.qZA()(),e.TgZ(53,"mat-form-field",20)(54,"mat-label"),e._uU(55,"Referencia"),e.qZA(),e.TgZ(56,"mat-select",23)(57,"mat-option",25),e._uU(58,"Interno"),e.qZA(),e.TgZ(59,"mat-option",25),e._uU(60,"Externo"),e.qZA()()()(),e.YNc(61,_t,5,2,"ng-container",11),e.YNc(62,ht,10,5,"ng-container",11),e.TgZ(63,"div",26)(64,"input",27),e.NdJ("change",function(r){return i.fileChangeEvent(r)}),e.qZA(),e.YNc(65,vt,3,3,"ng-container",11),e.YNc(66,yt,2,1,"div",11),e.qZA(),e.YNc(67,Zt,10,5,"ng-container",11),e.qZA()()(),e.BQk(),e.qZA()()()()),2&t&&(e.xp6(5),e.Q6J("routerLink",e.DdM(31,Tt)),e.xp6(3),e.Q6J("svgIcon","mat_solid:chevron_right"),e.xp6(1),e.Q6J("routerLink",e.DdM(32,Mt)),e.xp6(3),e.Q6J("svgIcon","mat_solid:chevron_right"),e.xp6(4),e.Q6J("svgIcon","mat_solid:chevron_right"),e.xp6(4),e.Q6J("ngIf","carousel"===i.mediaType),e.xp6(1),e.Q6J("ngIf","discount"===i.mediaType),e.xp6(1),e.Q6J("ngIf","banner_home"===i.mediaType),e.xp6(1),e.Q6J("ngIf","banner_product"===i.mediaType),e.xp6(1),e.Q6J("ngIf","offer"===i.mediaType),e.xp6(1),e.Q6J("ngIf","info"===i.mediaType),e.xp6(2),e.Q6J("ngIf","add"===i.mode),e.xp6(1),e.Q6J("ngIf","edit"===i.mode),e.xp6(7),e.Q6J("formGroup",i.mediaForm)("autocomplete","off"),e.xp6(5),e.Q6J("formControlName","title")("placeholder","T\xedtulo"),e.xp6(5),e.Q6J("formControlName","subtitle")("placeholder","Subt\xedtulo"),e.xp6(5),e.Q6J("formControlName","mediaType"),e.xp6(1),e.Q6J("ngForOf",e.lcZ(52,29,i.mediaTypes)),e.xp6(5),e.Q6J("formControlName","reference"),e.xp6(1),e.Q6J("value","internal"),e.xp6(2),e.Q6J("value","external"),e.xp6(2),e.Q6J("ngIf","external"===i.mediaForm.get("reference").value),e.xp6(1),e.Q6J("ngIf","internal"===i.mediaForm.get("reference").value),e.xp6(3),e.Q6J("ngIf",i.showCropper),e.xp6(1),e.Q6J("ngIf","edit"!==i.mode),e.xp6(1),e.Q6J("ngIf","edit"===i.mode))},dependencies:[u.yS,_.sg,_.O5,d._Y,d.Fj,d.JJ,d.JL,d.Q7,d.nD,d.sg,d.u,K.y,F.PQ,z.ey,U.zs,C.Hw,J.KE,J.hX,O.Nt,j.gD,H.ap,_.Ov,_.Nd],encapsulation:2,changeDetection:0}),n})(),bt=(()=>{class n{constructor(t,i){this._marketingService=t,this._router=i}resolve(t,i){const a=t.queryParams.mediaId;if(void 0!==a)return this._marketingService.getMediaById(a)}}return n.\u0275fac=function(t){return new(t||n)(e.LFG(k),e.LFG(u.F0))},n.\u0275prov=e.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),W=(()=>{class n{constructor(t){this._marketingService=t}resolve(t,i){return this._marketingService.getMediasByMerchant()}}return n.\u0275fac=function(t){return new(t||n)(e.LFG(k))},n.\u0275prov=e.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();var X=s(4380);const Ct=[{path:"",pathMatch:"full",redirectTo:"panels"},{path:"panels",component:te,children:[{path:"",component:ot},{path:"banners",component:ae},{path:"gallery",component:We,resolve:{products:X.SE,medias:W}},{path:"media",component:kt,resolve:{products:X.SE,medias:W,media:bt}}]}];let It=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({imports:[u.Bz.forChild(Ct),ee.m]}),n})()}}]);